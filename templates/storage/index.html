{% extends 'storage/base.html' %}

{% block title %}الصفحة الرئيسية - نظام تخزين الملفات{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h2>جميع الملفات المرفوعة ({{ total_files }})</h2>
    <a href="{% url 'upload_file' %}" class="btn">➕ رفع ملف جديد</a>
</div>

{% if page_obj %}
<table>
    <thead>
        <tr>
            <th>#</th>
            <th>اسم الملف</th>
            <th>نوع الملف</th>
            <th>الحجم</th>
            <th>تاريخ الرفع</th>
            <th>الإجراءات</th>
        </tr>
    </thead>
    <tbody>
        {% for file in page_obj %}
        <tr>
            <td>{{ file.id }}</td>
            <td>
                <a href="{% url 'file_detail' file.pk %}" style="color: #667eea; text-decoration: none; font-weight: 600;">
                    {{ file.original_filename }}
                </a>
            </td>
            <td>{{ file.content_type }}</td>
            <td>{{ file.get_file_size_display }}</td>
            <td>{{ file.uploaded_at|date:"Y-m-d H:i" }}</td>
            <td>
                <a href="{% url 'file_detail' file.pk %}" class="btn" style="padding: 8px 16px; font-size: 14px;">عرض</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Pagination -->
{% if page_obj.has_other_pages %}
<div class="pagination">
    {% if page_obj.has_previous %}
        <a href="?page=1">الأولى</a>
        <a href="?page={{ page_obj.previous_page_number }}">السابقة</a>
    {% endif %}
    
    <span class="current">
        صفحة {{ page_obj.number }} من {{ page_obj.paginator.num_pages }}
    </span>
    
    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">التالية</a>
        <a href="?page={{ page_obj.paginator.num_pages }}">الأخيرة</a>
    {% endif %}
</div>
{% endif %}

{% else %}
<div style="text-align: center; padding: 60px 20px; color: #6c757d;">
    <h3>لا توجد ملفات مرفوعة حتى الآن</h3>
    <p style="margin: 20px 0;">ابدأ برفع ملفك الأول!</p>
    <a href="{% url 'upload_file' %}" class="btn">رفع ملف جديد</a>
</div>
{% endif %}
{% endblock %}
